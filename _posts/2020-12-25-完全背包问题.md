---
layout:     post   				    
title:      完全背包问题				
subtitle:   背包问题[二]
date:       2020-12-25 				
author:     WarmStar
header-img: img/blog9.jpg 	
catalog: true 				
tags:							
    - 算法
---

## 完全背包问题

##### 定义

给定`n`种重量为 `w1, w2, w3, ..., wn`, 价值为 `v1, v2, v3, ..., vn` 的物品和容量为`c`的背包，其中这 n 种物品每种均可以无限制地拿取，找出一个拿取方法使得在满足背包的容量的前提下，包内物品的总价值最大。该问题与`01背包问题`的唯一区别就是每种物品的数量是无限制的。

##### 分析

由于这里的物品选取规则不再是限定于`拿或不拿`两种，不再适合画树状图分析了。

最开始看到这个问题，很直接地就想到只拿性价比最高的物品不就可以了，就是只拿`价值/重量`最大的物品，如果有剩余空间的话，再去性价比较低的里面找物品填充。乍一看没毛病，但可以很容易的举出反例：假设有两个物品，物品 A 的价值为 5 重量为 5 ，物品 B 的价值为 8 重量为 6，背包的容量为10。物品 B 的性价比显然要比物品 A 高，如果用上述追求性价比的贪心思路则会只放入一个物品B，但实际上这里选择拿两个物品 A 才是最优解，所以此路不通。

<br/>

## 可行性验证

该问题也可以像`01背包问题`那样使用动态规划方法解决。[01背包问题可行性验证](https://vixeruntr.github.io/2020/11/19/01%E8%83%8C%E5%8C%85%E9%97%AE%E9%A2%98/#%E5%8F%AF%E8%A1%8C%E6%80%A7%E9%AA%8C%E8%AF%81)

##### 最优化原理

这里仍然使用反证法：预设完全背包的解为`F(n1, n2, …, nN)(ni表示第i件物品的选取数量)`。子问题为：将前 i 种物品放入容量为 c 的背包并取得最大价值，其对应的最优解为`F(n1, n2, …, ni)`，假设该解不是子问题的最优解，存在另一组解`F(m1, m2, …, mi)`才是该子问题的最优解，那么`F(m1, m2, …, mi, …, nN) `必然大于`F(n1, n2, …, ni, …, nN)`，则`F(n1, n2, …, nN) `不是原问题的最优解，与预设矛盾，所以`F(n1, n2, …, ni)`必然是子问题的最优解。

##### 无后效性

对于子问题的任意解，都不会影响后续子问题的解，也就是说前 i 种物品无论如何选择，只要最终剩余的背包容量不变，就不会影响后面物品的选择。即满足无后效性。

<br/>

## 动态规划方法

首先定义函数  `F(i, j): 表示背包剩余容量为j时, 前i个物品可以获得的最大价值.`

假设此时已经选择完了前`i-1`个物品并且已经得到了这些物品的最大价值组合，面对第`i`个物品有`k`种选择，即可以选择`0 ~ k`个该物品且满足`0 <= k * wi <= j`:

##### 递归关系式

```
F(i, j) = max{F(i - 1, j - k * wi) + k * vi}	         (0 <= k * wi <= j)	
```

##### Python 代码

第三层 for 循环`k`的范围在`0 ~ (j // w[i - 1]) + 1`，即面对第`i`件物品，可以最少选 0 个，最多选`j // w[i - 1]`个，由它的重量决定。该层循环计算出`k`种结果取最大值。

```python
def bag_comp(n, c, w, v):
    value = [[0 for j in range(c + 1)] for i in range(n + 1)]
    for i in range(1, n + 1):
        for j in range(1, c + 1):
            for k in range((j // w[i - 1]) + 1):
                value[i][j] = max(
                    value[i][j], 
                    value[i - 1][j - k * w[i - 1]] + k * v[i - 1]
                )
    return value[-1][-1]
```

##### 填表法

为了更直观的理解细节，使用表格依次填入数据。表中`i`表示`可选择到第i个`物品,  `j`表示剩余的容量大小，表格中的数值即为`F(i, j)`。2个物品的属性按顺序列在表格左侧，方便对照。

1. 先将`i=0`的行与`j=0`列填入0。

   ![bag09.jpg](https://e.im5i.com/2021/01/05/bag09.jpg)

2. 





