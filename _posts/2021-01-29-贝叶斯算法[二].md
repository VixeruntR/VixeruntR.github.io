---
layout:     post   				    
title:      朴素贝叶斯算法[二] 				
subtitle:    
date:       2021-01-29 				
author:     WarmStar 						
header-img: img/blog16.jpg 	
catalog: true 				
tags:							
    - ML
---

### 垃圾邮件分类

介绍完了朴素贝叶斯算法的原理和代码实现，这里实现一个经典的垃圾邮件分类任务。

##### 数据集

数据集来自网络。[下载地址](https://github.com/VixeruntR/MyData/blob/master/NaiveBayesian/email.rar) 

```python
import re
import os

def mail2word(mail_content):
    # 以任意非字母或非数字切分整个邮件内容
    
    words = re.split(r'\W+', mail_content)
    # 仅保留长度大于2且不含数字的单词 且全部转化为小写
    
    words = [word.lower() for word in words if
             len(word) > 2 and not bool(re.search(r'\d', word))]
    return words

def create_glossary(words_list):
    glossary = set([])
    for words in words_list:
        glossary = glossary | set(words)
    return list(glossary)

def get_dataset(root):
    word_list = []
    label_list = []
    spam_root = os.path.join(root, 'spam')
    for spam_file in os.listdir(spam_root):
        spam_file_path = os.path.join(spam_root, spam_file)
        words = mail2word(open(spam_file_path, 'r').read())
        word_list.append(words)
        label_list.append(1)

    ham_root = os.path.join(root, 'ham')
    for ham_file in os.listdir(ham_root):
        ham_file_path = os.path.join(ham_root, ham_file)
        words = mail2word(open(ham_file_path, 'r').read())
        word_list.append(words)
        label_list.append(0)
    return word_list, label_list

if __name__ == '__main__':
    word_list, label_list = get_dataset('data/email/')
    glossary = create_glossary(word_list)
```